version: '3'

services:
  uav-ue:
    container_name: uav-ue
    restart: always
    image: "jenssgb/rtspffmpeg:base"
    depends_on:
      - rtsp-server
    volumes:
      - ./media/:/media
    network_mode: "host"
    command: "ffmpeg -re -stream_loop -1 -i /media/test.mp4 -vf 'fps=6'  -b:v 1M  -maxrate 1M -bufsize 500K -f rtsp rtsp://localhost:8554/compose-rtsp"
  
  rtsp-server:
    container_name: rtsp-server-base
    restart: always
    image: "aler9/rtsp-simple-server"
    network_mode: "host"
  
  nrt:
    container_name: nrt
    build: .
    image: nrt
    # env_file: ./.env
    ports: 
      - 5000:5000 
    #restart: on-failure
    # volumes:
    #  - ./app:/app    
    network_mode: "host"
